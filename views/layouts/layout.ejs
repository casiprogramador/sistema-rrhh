<!DOCTYPE html>
<html lang="en">
<head>
    <style type="text/css">
      @media all {
         div.saltopagina{
            display: none;
         }
      }
       
      @media print{
         div.saltopagina{
            display:block;
            page-break-before:always;
         }
       
         /*No imprimir*/
         .oculto {display:none}
      } 
    </style>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Recursos Humanos</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="/css/perfect-scrollbar.min.css">

  <link rel="stylesheet" href="/css/materialdesignicons.css">
  

 <link type="text/css" rel="stylesheet" href="/css/dataTables.bootstrap4.css" >
<link rel="stylesheet" type="text/css" href="/css/buttons.dataTables.min.css">
  <!-- endinject -->
  <!-- inject:css -->
  <link rel="stylesheet" href="/css/style.css">
  
  <link type="text/css" href="/css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="/css/jquery-clockpicker.min.css" />
  <!-- endinject -->
  <link rel="shortcut icon" href="/images/iconlogo.png" >
   <%- block('style').toString() %>
</head>

<body>
  <%- body -%>
  <!-- container-scroller -->
  <!-- plugins:js -->
  
  <script src="/js/jquery.min.js"></script>
  <script src="/js/popper.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/bootstrap-datepicker.min.js"></script>
  <script src="/js/perfect-scrollbar.jquery.min.js"></script>
  <script src="/js/jquery-clockpicker.min.js"></script>
  <script src="/js/jquery.validate.min.js"></script>
  <script src="/js/jquery.form-validation.js"></script>

  <script src="/js/jquery.dataTables.js"></script>
  <script src="/js/dataTables.bootstrap4.js"></script>
  <script src="/libs/jspdf.debug.js"></script>
  <script src="/libs/jspdf.plugin.autotable.js"></script>
  <script src="/js/dropify.min.js"></script>
  
  <!-- endinject -->
  <script src="/js/jquery.validate.min.js"></script>
  <!-- inject:js -->
  <script src="/js/off-canvas.js"></script>
  <script src="/js/hoverable-collapse.js"></script>
  <script src="/js/misc.js"></script>
  <script src="/js/dropify.js"></script>
  <script src="/js/dinamico.js"></script>
  <script src="/js/jquery.repeater.min.js"></script>

  <!-- impresion ficha personal -->
  <script src="/js/impresionficha.js"></script>


  <!-- export datatable -->
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.flash.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.print.min.js"></script>
  
    <!-- wizard jquery -->
    <script src="/js/jquery.steps.js"></script>

  
    <!-- endinject -->
  
    <!-- script por cada pagina -->
  <script src="/js/script.js"></script>
  <script src="/js/filesaver.js"></script>
  <script src="/js/boleta.js"></script>
  <script src="/js/saldovacacion.js"></script>
  <script src="/js/formulario_boletas_vacacion.js"></script>
  <script src="/js/prescripcion.js"></script>
  <script src="/js/administrarboleta.js"></script>
  <script src="/js/consultamarcado.js"></script>
  <script src="/js/nuevopersonal.js"></script>
  <!-- inject:js -->


  <script>
    function buscar(){
      var ci=getElementById("civacacion").innerHTML;
      alert("ci");
    }
    
    
    
    function busqueda() {    
      var pg = require('pg');  
      var ci=getElementById("civacacion");
      var conectionstring="postgres://postgres:postgres@localhost:5432/dbrrhh";
      var pgClient= new pgClient(conectionstring);
      pgClient.connect();
      var query=pgClient.query('SELECT  * FROM public."Empleados" e, public."Contratos" c, public."Cargos" a , public."Areas" r, public."Saldo_Vacacions" s WHERE e.id='+ci+' and  e.id=c.id_empleado and c.id_cargo=a.id and e.estado=true and a.id_area=r.id and s.id_empleado = e.id');
      query.on("row",function(row,result){
        result.addRow(row);
        if(!result)
        alert("no");
      });
    }
    
    function valida(e){
        tecla = (document.all) ? e.keyCode : e.which;
    
        //Tecla de retroceso para borrar, siempre la permite
        if (tecla==8){
            return true;
        }
            
        // Patron de entrada, en este caso solo acepta numeros
        patron =/[0-9]/;
        tecla_final = String.fromCharCode(tecla);
        return patron.test(tecla_final);
    }
    
    
    function generate() {
      //document.getElementById('tabladatos').rows[i].cells.length ----- numero de columnas de la tabla-
      //document.getElementById("tabladatos").rows.length  ----- numero de columnas de la tabla |
      var columns = ["C. I.", "Nombre", "Cargo", "Fecha de Ingreso","Antiguedad","Saldo","Gestiones Pendientes","",""]  ;
      var col=parseInt(document.getElementById('table').rows[0].cells.length);
      var fil=parseInt(document.getElementById("table").rows.length);
      var tabla=document.getElementById("table");
      var data =new Array(fil);
      for(var i=1;i<fil;i++){
          var texto="";
          var fila=new Array(9);
          for(var j=1;j<col;j++){
              fila[j]=document.getElementById('table').rows[i].cells[j].innerText;
          }
          data[i]=fila;
      }
      var doc = new jsPDF('l','pt','Legal');
      doc.setFontSize('Arial','B',11);
      var logo=new Image();
      logo.src='/images/logo2.jpg';
      doc.addImage(logo, 'JPEG', 15, 2, 80, 40);
      doc.autoTable(columns, data);
      doc.output("dataurlnewwindow");
    }
    
    
        $(document).ready(function(){
          $( "#fecha-saldo-vacacion").val(getCurrentDate());
          // $( "#panel-personal").hide();
          $( "#form-saldo-vacacion" ).submit(function( event ) {
            area = $( "#areas-select-vacacion option:selected" ).val();
            fecha = $( "#fecha-saldo-vacacion").val();
            tipo = $('input[name=tipo_personal]:checked').val();
            //console.log(area);
            //console.log(fecha);
            //console.log(tipo);
            $( "#panel-personal").show();
            //Ajax jquery
            var data = {};
            data.area = area;
            $.ajax({
                type: 'GET',
                contentType: 'application/json',
                url: 'http://localhost:3000/area',						
                success: function(data) {
                      //console.log('success');
                      //console.log(JSON.stringify(data));
                      $.each(data, function (key, area) {
                          
                          $.ajax({
                              type: 'GET',
                              contentType: 'application/json',
                              url: 'http://localhost:3000/empleado/'+area.id +'/area',						
                              success: function(data) {
                                    $.each(data, function (key, empleado) {
                                        console.log(empleado)
                                    })
                                  }
                          });
                          console.log(area.desc_area )
                      })
                    }
            });
            event.preventDefault();
          });
        });
    
        function getCurrentDate(){
          var today = new Date();
          var dd = today.getDate();
          var mm = today.getMonth()+1; //January is 0!
    
          var yyyy = today.getFullYear();
          if(dd<10){
              dd='0'+dd;
          } 
          if(mm<10){
              mm='0'+mm;
          } 
          var today = dd+'/'+mm+'/'+yyyy;
          return today;
        }
    
     
    </script>
  
  <%- block('javascript').toString() %>

</body>


</html>